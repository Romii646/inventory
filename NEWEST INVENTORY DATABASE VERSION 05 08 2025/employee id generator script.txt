DELIMITER $$

CREATE FUNCTION generate_employee_id() RETURNS VARCHAR(25)
DETERMINISTIC
BEGIN
	DECLARE last_id INT;
    SET last_id = (SELECT MAX(CAST(RIGHT(employee_id, 4) AS UNSIGNED)) FROM employees);
    IF last_id IS NULL THEN
    	SET last_id = 0;
    END IF;
    RETURN CONCAT ('EMP', LPAD(last_id + 1, 4, '0'));
END $$    
DELIMITER ;